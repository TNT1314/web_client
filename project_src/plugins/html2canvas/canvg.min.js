/*! map_marker-1.0.0.js */

if(!window.console){window.console={};window.console.log=function(a){};window.console.dir=function(a){}}(function(){this.canvg=function(a,b){if(typeof a=="string"){a=document.getElementById(a)}var c;if(a.svg==null){c=build();a.svg=c}else{c=a.svg;c.stop()}var d=a.getContext("2d");if(b.substr(0,1)=="<"){c.loadXml(d,b)}else{c.load(d,b)}};function build(){var svg={};svg.FRAMERATE=30;svg.init=function(a){svg.Definitions={};svg.Styles={};svg.Animations=[];svg.ctx=a;svg.ViewPort=new function(){this.viewPorts=[];this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(a){if(a!=null&&typeof a=="number")return a;if(a=="x")return this.width();if(a=="y")return this.height();return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};svg.init();svg.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};svg.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")};svg.ajax=function(a){var b;if(window.XMLHttpRequest){b=new XMLHttpRequest}else{b=new ActiveXObject("Microsoft.XMLHTTP")}if(b){b.open("GET",a,false);b.send(null);return b.responseText}return null};svg.parseXml=function(a){if(window.DOMParser){var b=new DOMParser;return b.parseFromString(a,"text/xml")}else{a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var c=new ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(a);return c}};svg.Property=function(a,b){this.name=a;this.value=b;this.hasValue=function(){return this.value!=null&&this.value!=""};this.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);if((this.value+"").match(/%$/)){a=a/100}return a};this.valueOrDefault=function(a){if(this.hasValue())return this.value;return a};this.numValueOrDefault=function(a){if(this.hasValue())return this.numValue();return a};var c=this;this.Color={addOpacity:function(a){var b=c.value;if(a!=null&&a!=""){var d=new RGBColor(c.value);if(d.ok){b="rgba("+d.r+", "+d.g+", "+d.b+", "+a+")"}}return new svg.Property(c.name,b)}};this.Definition={getDefinition:function(){var a=c.value.replace(/^(url\()?#([^\)]+)\)?$/,"$2");return svg.Definitions[a]},isUrl:function(){return c.value.indexOf("url(")==0},getFillStyle:function(a){var b=this.getDefinition();if(b!=null&&b.createGradient){return b.createGradient(svg.ctx,a)}if(b!=null&&b.createPattern){return b.createPattern(svg.ctx,a)}return null}};this.Length={DPI:function(a){return 96},EM:function(a){var b=12;var c=new svg.Property("fontSize",svg.Font.Parse(svg.ctx.font).fontSize);if(c.hasValue())b=c.Length.toPixels(a);return b},toPixels:function(a){if(!c.hasValue())return 0;var b=c.value+"";if(b.match(/em$/))return c.numValue()*this.EM(a);if(b.match(/ex$/))return c.numValue()*this.EM(a)/2;if(b.match(/px$/))return c.numValue();if(b.match(/pt$/))return c.numValue()*1.25;if(b.match(/pc$/))return c.numValue()*15;if(b.match(/cm$/))return c.numValue()*this.DPI(a)/2.54;if(b.match(/mm$/))return c.numValue()*this.DPI(a)/25.4;if(b.match(/in$/))return c.numValue()*this.DPI(a);if(b.match(/%$/))return c.numValue()*svg.ViewPort.ComputeSize(a);return c.numValue()}};this.Time={toMilliseconds:function(){if(!c.hasValue())return 0;var a=c.value+"";if(a.match(/s$/))return c.numValue()*1e3;if(a.match(/ms$/))return c.numValue();return c.numValue()}};this.Angle={toRadians:function(){if(!c.hasValue())return 0;var a=c.value+"";if(a.match(/deg$/))return c.numValue()*(Math.PI/180);if(a.match(/grad$/))return c.numValue()*(Math.PI/200);if(a.match(/rad$/))return c.numValue();return c.numValue()*(Math.PI/180)}}};svg.Font=new function(){this.Styles=["normal","italic","oblique","inherit"];this.Variants=["normal","small-caps","inherit"];this.Weights=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"];this.CreateFont=function(a,b,c,d,e,f){var g=f!=null?this.Parse(f):this.CreateFont("","","","","",svg.ctx.font);return{fontFamily:e||g.fontFamily,fontSize:d||g.fontSize,fontStyle:a||g.fontStyle,fontWeight:c||g.fontWeight,fontVariant:b||g.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(b){var c={};var d=svg.trim(svg.compressSpaces(b||"")).split(" ");var e={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false};var f="";for(var g=0;g<d.length;g++){if(!e.fontStyle&&a.Styles.indexOf(d[g])!=-1){if(d[g]!="inherit")c.fontStyle=d[g];e.fontStyle=true}else if(!e.fontVariant&&a.Variants.indexOf(d[g])!=-1){if(d[g]!="inherit")c.fontVariant=d[g];e.fontStyle=e.fontVariant=true}else if(!e.fontWeight&&a.Weights.indexOf(d[g])!=-1){if(d[g]!="inherit")c.fontWeight=d[g];e.fontStyle=e.fontVariant=e.fontWeight=true}else if(!e.fontSize){if(d[g]!="inherit")c.fontSize=d[g].split("/")[0];e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=true}else{if(d[g]!="inherit")f+=d[g]}}if(f!="")c.fontFamily=f;return c}};svg.ToNumberArray=function(a){var b=svg.trim(svg.compressSpaces((a||"").replace(/,/g," "))).split(" ");for(var c=0;c<b.length;c++){b[c]=parseFloat(b[c])}return b};svg.Point=function(a,b){this.x=a;this.y=b;this.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)}};svg.CreatePoint=function(a){var b=svg.ToNumberArray(a);return new svg.Point(b[0],b[1])};svg.CreatePath=function(a){var b=svg.ToNumberArray(a);var c=[];for(var d=0;d<b.length;d+=2){c.push(new svg.Point(b[d],b[d+1]))}return c};svg.BoundingBox=function(a,b,c,d){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(a,b){if(a!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=a;this.x2=a}if(a<this.x1)this.x1=a;if(a>this.x2)this.x2=a}if(b!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=b;this.y2=b}if(b<this.y1)this.y1=b;if(b>this.y2)this.y2=b}};this.addX=function(a){this.addPoint(a,null)};this.addY=function(a){this.addPoint(null,a)};this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a);var h=b+2/3*(d-b);var i=g+1/3*(e-a);var j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)};this.addBezierCurve=function(a,b,c,d,e,f,g,h){var j=[a,b],k=[c,d],l=[e,f],m=[g,h];this.addPoint(j[0],j[1]);this.addPoint(m[0],m[1]);for(i=0;i<=1;i++){var n=function(a){return Math.pow(1-a,3)*j[i]+3*Math.pow(1-a,2)*a*k[i]+3*(1-a)*Math.pow(a,2)*l[i]+Math.pow(a,3)*m[i]};var o=6*j[i]-12*k[i]+6*l[i];var p=-3*j[i]+9*k[i]-9*l[i]+3*m[i];var q=3*k[i]-3*j[i];if(p==0){if(o==0)continue;var r=-q/o;if(0<r&&r<1){if(i==0)this.addX(n(r));if(i==1)this.addY(n(r))}continue}var s=Math.pow(o,2)-4*q*p;if(s<0)continue;var t=(-o+Math.sqrt(s))/(2*p);if(0<t&&t<1){if(i==0)this.addX(n(t));if(i==1)this.addY(n(t))}var u=(-o-Math.sqrt(s))/(2*p);if(0<u&&u<1){if(i==0)this.addX(n(u));if(i==1)this.addY(n(u))}}};this.addPoint(a,b);this.addPoint(c,d)};svg.Transform=function(v){var that=this;this.Type={};this.Type.translate=function(a){this.p=svg.CreatePoint(a);this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)}};this.Type.rotate=function(a){var b=svg.ToNumberArray(a);this.angle=new svg.Property("angle",b[0]);this.cx=b[1]||0;this.cy=b[2]||0;this.apply=function(a){a.translate(this.cx,this.cy);a.rotate(this.angle.Angle.toRadians());a.translate(-this.cx,-this.cy)}};this.Type.scale=function(a){this.p=svg.CreatePoint(a);this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)}};this.Type.matrix=function(a){this.m=svg.ToNumberArray(a);this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])}};this.Type.SkewBase=function(a){this.base=that.Type.matrix;this.base(a);this.angle=new svg.Property("angle",a)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(a){this.base=that.Type.SkewBase;this.base(a);this.m=[1,0,Math.tan(this.angle.Angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(a){this.base=that.Type.SkewBase;this.base(a);this.m=[1,Math.tan(this.angle.Angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(a){for(var b=0;b<this.transforms.length;b++){this.transforms[b].apply(a)}};var data=v.split(/\s(?=[a-z])/);for(var i=0;i<data.length;i++){var type=data[i].split("(")[0];var s=data[i].split("(")[1].replace(")","");var transform=eval("new this.Type."+type+"(s)");this.transforms.push(transform)}};svg.Element={};svg.Element.ElementBase=function(a){this.attributes={};this.styles={};this.children=[];this.attribute=function(a,b){var c=this.attributes[a];if(c!=null)return c;c=new svg.Property(a,"");if(b==true)this.attributes[a]=c;return c};this.style=function(a,b){var c=this.styles[a];if(c!=null)return c;var d=this.attribute(a);if(d!=null&&d.hasValue()){return d}c=new svg.Property(a,"");if(b==true)this.styles[a]=c;return c};this.render=function(a){a.save();this.setContext(a);this.renderChildren(a);this.clearContext(a);a.restore()};this.setContext=function(a){};this.clearContext=function(a){};this.renderChildren=function(a){for(var b=0;b<this.children.length;b++){this.children[b].render(a)}};this.addChild=function(a,b){var c=a;if(b)c=svg.CreateElement(a);c.parent=this;this.children.push(c)};if(a!=null&&a.nodeType==1){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c.nodeType==1)this.addChild(c,true)}for(var b=0;b<a.attributes.length;b++){var d=a.attributes[b];this.attributes[d.nodeName]=new svg.Property(d.nodeName,d.nodeValue)}var e=svg.Styles[this.type];if(e!=null){for(var f in e){this.styles[f]=e[f]}}if(this.attribute("class").hasValue()){var g=svg.compressSpaces(this.attribute("class").value).split(" ");for(var h=0;h<g.length;h++){e=svg.Styles["."+g[h]];if(e!=null){for(var f in e){this.styles[f]=e[f]}}}}if(this.attribute("style").hasValue()){var e=this.attribute("style").value.split(";");for(var b=0;b<e.length;b++){if(svg.trim(e[b])!=""){var i=e[b].split(":");var f=svg.trim(i[0]);var j=svg.trim(i[1]);this.styles[f]=new svg.Property(f,j)}}}if(this.attribute("id").hasValue())svg.Definitions[this.attribute("id").value]=this}};svg.Element.RenderedElementBase=function(a){this.base=svg.Element.ElementBase;this.base(a);this.setContext=function(a){if(this.style("fill").Definition.isUrl()){var b=this.style("fill").Definition.getFillStyle(this);if(b!=null)a.fillStyle=b}else if(this.style("fill").hasValue()){var c=this.style("fill");if(this.style("fill-opacity").hasValue())c=c.Color.addOpacity(this.style("fill-opacity").value);a.fillStyle=c.value=="none"?"rgba(0,0,0,0)":c.value}if(this.style("stroke").Definition.isUrl()){var b=this.style("stroke").Definition.getFillStyle(this);if(b!=null)a.strokeStyle=b}else if(this.style("stroke").hasValue()){var d=this.style("stroke");if(this.style("stroke-opacity").hasValue())d=d.Color.addOpacity(this.style("stroke-opacity").value);a.strokeStyle=d.value=="none"?"rgba(0,0,0,0)":d.value}if(this.style("stroke-width").hasValue())a.lineWidth=this.style("stroke-width").Length.toPixels();if(this.style("stroke-linecap").hasValue())a.lineCap=this.style("stroke-linecap").value;if(this.style("stroke-linejoin").hasValue())a.lineJoin=this.style("stroke-linejoin").value;if(this.style("stroke-miterlimit").hasValue())a.miterLimit=this.style("stroke-miterlimit").value;if(typeof a.font!="undefined"){a.font=svg.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").Length.toPixels()+"px":"",this.style("font-family").value).toString()}if(this.attribute("transform").hasValue()){var e=new svg.Transform(this.attribute("transform").value);e.apply(a)}if(this.attribute("clip-path").hasValue()){var f=this.attribute("clip-path").Definition.getDefinition();if(f!=null)f.apply(a)}if(this.style("opacity").hasValue()){a.globalAlpha=this.style("opacity").numValue()}}};svg.Element.RenderedElementBase.prototype=new svg.Element.ElementBase;svg.Element.PathElementBase=function(a){this.base=svg.Element.RenderedElementBase;this.base(a);this.path=function(a){if(a!=null)a.beginPath();return new svg.BoundingBox};this.renderChildren=function(a){this.path(a);if(a.fillStyle!="")a.fill();if(a.strokeStyle!="")a.stroke();var b=this.getMarkers();if(b!=null){if(this.attribute("marker-start").Definition.isUrl()){var c=this.attribute("marker-start").Definition.getDefinition();c.render(a,b[0][0],b[0][1])}if(this.attribute("marker-mid").Definition.isUrl()){var c=this.attribute("marker-mid").Definition.getDefinition();for(var d=1;d<b.length-1;d++){c.render(a,b[d][0],b[d][1])}}if(this.attribute("marker-end").Definition.isUrl()){var c=this.attribute("marker-end").Definition.getDefinition();c.render(a,b[b.length-1][0],b[b.length-1][1])}}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};svg.Element.PathElementBase.prototype=new svg.Element.RenderedElementBase;svg.Element.svg=function(a){this.base=svg.Element.RenderedElementBase;this.base(a);this.baseClearContext=this.clearContext;this.clearContext=function(a){this.baseClearContext(a);svg.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);if(this.attribute("x").hasValue()&&this.attribute("y").hasValue()){a.translate(this.attribute("x").Length.toPixels("x"),this.attribute("y").Length.toPixels("y"))}var b=svg.ViewPort.width();var c=svg.ViewPort.height();if(this.attribute("width").hasValue()&&this.attribute("height").hasValue()){b=this.attribute("width").Length.toPixels("x");c=this.attribute("height").Length.toPixels("y");var d=0;var e=0;if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){d=-this.attribute("refX").Length.toPixels("x");e=-this.attribute("refY").Length.toPixels("y")}a.beginPath();a.moveTo(d,e);a.lineTo(b,e);a.lineTo(b,c);a.lineTo(d,c);a.closePath();a.clip()}svg.ViewPort.SetCurrent(b,c);if(this.attribute("viewBox").hasValue()){var f=svg.ToNumberArray(this.attribute("viewBox").value);var g=f[0];var h=f[1];b=f[2];c=f[3];var i=svg.compressSpaces(this.attribute("preserveAspectRatio").value);i=i.replace(/^defer\s/,"");var j=i.split(" ")[0]||"xMidYMid";var k=i.split(" ")[1]||"meet";var l=svg.ViewPort.width()/b;var m=svg.ViewPort.height()/c;var n=Math.min(l,m);var o=Math.max(l,m);if(k=="meet"){b*=n;c*=n}if(k=="slice"){b*=o;c*=o}if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){a.translate(-n*this.attribute("refX").Length.toPixels("x"),-n*this.attribute("refY").Length.toPixels("y"))}else{if(j.match(/^xMid/)&&(k=="meet"&&n==m||k=="slice"&&o==m))a.translate(svg.ViewPort.width()/2-b/2,0);if(j.match(/YMid$/)&&(k=="meet"&&n==l||k=="slice"&&o==l))a.translate(0,svg.ViewPort.height()/2-c/2);if(j.match(/^xMax/)&&(k=="meet"&&n==m||k=="slice"&&o==m))a.translate(svg.ViewPort.width()-b,0);if(j.match(/YMax$/)&&(k=="meet"&&n==l||k=="slice"&&o==l))a.translate(0,svg.ViewPort.height()-c)}if(k=="meet")a.scale(n,n);if(k=="slice")a.scale(o,o);a.translate(-g,-h);svg.ViewPort.RemoveCurrent();svg.ViewPort.SetCurrent(f[2],f[3])}a.strokeStyle="rgba(0,0,0,0)";a.lineCap="butt";a.lineJoin="miter";a.miterLimit=4}};svg.Element.svg.prototype=new svg.Element.RenderedElementBase;svg.Element.rect=function(a){this.base=svg.Element.PathElementBase;this.base(a);this.path=function(a){var b=this.attribute("x").Length.toPixels("x");var c=this.attribute("y").Length.toPixels("y");var d=this.attribute("width").Length.toPixels("x");var e=this.attribute("height").Length.toPixels("y");var f=this.attribute("rx").Length.toPixels("x");var g=this.attribute("ry").Length.toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue())g=f;if(this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue())f=g;if(a!=null){a.beginPath();a.moveTo(b+f,c);a.lineTo(b+d-f,c);a.quadraticCurveTo(b+d,c,b+d,c+g);a.lineTo(b+d,c+e-g);a.quadraticCurveTo(b+d,c+e,b+d-f,c+e);a.lineTo(b+f,c+e);a.quadraticCurveTo(b,c+e,b,c+e-g);a.lineTo(b,c+g);a.quadraticCurveTo(b,c,b+f,c);a.closePath()}return new svg.BoundingBox(b,c,b+d,c+e)}};svg.Element.rect.prototype=new svg.Element.PathElementBase;svg.Element.circle=function(a){this.base=svg.Element.PathElementBase;this.base(a);this.path=function(a){var b=this.attribute("cx").Length.toPixels("x");var c=this.attribute("cy").Length.toPixels("y");var d=this.attribute("r").Length.toPixels();if(a!=null){a.beginPath();a.arc(b,c,d,0,Math.PI*2,true);a.closePath()}return new svg.BoundingBox(b-d,c-d,b+d,c+d)}};svg.Element.circle.prototype=new svg.Element.PathElementBase;svg.Element.ellipse=function(a){this.base=svg.Element.PathElementBase;this.base(a);this.path=function(a){var b=4*((Math.sqrt(2)-1)/3);var c=this.attribute("rx").Length.toPixels("x");var d=this.attribute("ry").Length.toPixels("y");var e=this.attribute("cx").Length.toPixels("x");var f=this.attribute("cy").Length.toPixels("y");if(a!=null){a.beginPath();a.moveTo(e,f-d);a.bezierCurveTo(e+b*c,f-d,e+c,f-b*d,e+c,f);a.bezierCurveTo(e+c,f+b*d,e+b*c,f+d,e,f+d);a.bezierCurveTo(e-b*c,f+d,e-c,f+b*d,e-c,f);a.bezierCurveTo(e-c,f-b*d,e-b*c,f-d,e,f-d);a.closePath()}return new svg.BoundingBox(e-c,f-d,e+c,f+d)}};svg.Element.ellipse.prototype=new svg.Element.PathElementBase;svg.Element.line=function(a){this.base=svg.Element.PathElementBase;this.base(a);this.getPoints=function(){return[new svg.Point(this.attribute("x1").Length.toPixels("x"),this.attribute("y1").Length.toPixels("y")),new svg.Point(this.attribute("x2").Length.toPixels("x"),this.attribute("y2").Length.toPixels("y"))]};this.path=function(a){var b=this.getPoints();if(a!=null){a.beginPath();a.moveTo(b[0].x,b[0].y);a.lineTo(b[1].x,b[1].y)}return new svg.BoundingBox(b[0].x,b[0].y,b[1].x,b[1].y)};this.getMarkers=function(){var a=this.getPoints();var b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}};svg.Element.line.prototype=new svg.Element.PathElementBase;svg.Element.polyline=function(a){this.base=svg.Element.PathElementBase;this.base(a);this.points=svg.CreatePath(this.attribute("points").value);this.path=function(a){var b=new svg.BoundingBox(this.points[0].x,this.points[0].y);if(a!=null){a.beginPath();a.moveTo(this.points[0].x,this.points[0].y)}for(var c=1;c<this.points.length;c++){b.addPoint(this.points[c].x,this.points[c].y);if(a!=null)a.lineTo(this.points[c].x,this.points[c].y)}return b};this.getMarkers=function(){var a=[];for(var b=0;b<this.points.length-1;b++){a.push([this.points[b],this.points[b].angleTo(this.points[b+1])])}a.push([this.points[this.points.length-1],a[a.length-1][1]]);return a}};svg.Element.polyline.prototype=new svg.Element.PathElementBase;svg.Element.polygon=function(a){this.base=svg.Element.polyline;this.base(a);this.basePath=this.path;this.path=function(a){var b=this.basePath(a);if(a!=null){a.lineTo(this.points[0].x,this.points[0].y);a.closePath()}return b}};svg.Element.polygon.prototype=new svg.Element.polyline;svg.Element.path=function(a){this.base=svg.Element.PathElementBase;this.base(a);var b=this.attribute("d").value;b=b.replace(/,/gm," ");b=b.replace(/([A-Za-z])([A-Za-z])/gm,"$1 $2");b=b.replace(/([A-Za-z])([A-Za-z])/gm,"$1 $2");b=b.replace(/([A-Za-z])([^\s])/gm,"$1 $2");b=b.replace(/([^\s])([A-Za-z])/gm,"$1 $2");b=b.replace(/([0-9])([+\-])/gm,"$1 $2");b=b.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");b=b.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");b=svg.compressSpaces(b);b=svg.trim(b);this.PathParser=new function(a){this.tokens=a.split(" ");this.reset=function(){this.i=-1;this.command="";this.control=new svg.Point(0,0);this.current=new svg.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i==this.tokens.length-1};this.isCommandOrEnd=function(){if(this.isEnd())return true;return this.tokens[this.i+1].match(/[A-Za-z]/)!=null};this.isRelativeCommand=function(){return this.command==this.command.toLowerCase()};this.getToken=function(){this.i=this.i+1;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.command=this.getToken()};this.getPoint=function(){var a=new svg.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)};this.getAsControlPoint=function(){var a=this.getPoint();this.control=a;return a};this.getAsCurrentPoint=function(){var a=this.getPoint();this.current=a;return a};this.getReflectedControlPoint=function(){var a=new svg.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return this.makeAbsolute(a)};this.makeAbsolute=function(a){if(this.isRelativeCommand()){a.x=this.current.x+a.x;a.y=this.current.y+a.y}return a};this.addMarker=function(a,b){this.addMarkerAngle(a,b==null?null:b.angleTo(a))};this.addMarkerAngle=function(a,b){this.points.push(a);this.angles.push(b)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++){if(this.angles[a]==null){for(var b=a+1;b<this.angles.length;b++){if(this.angles[b]!=null){this.angles[a]=this.angles[b];break}}}}return this.angles}}(b);this.path=function(a){var b=this.PathParser;b.reset();var c=new svg.BoundingBox;if(a!=null)a.beginPath();while(!b.isEnd()){b.nextCommand();if(b.command.toUpperCase()=="M"){var d=b.getAsCurrentPoint();b.addMarker(d);c.addPoint(d.x,d.y);if(a!=null)a.moveTo(d.x,d.y);while(!b.isCommandOrEnd()){var d=b.getAsCurrentPoint();b.addMarker(d);c.addPoint(d.x,d.y);if(a!=null)a.lineTo(d.x,d.y)}}else if(b.command.toUpperCase()=="L"){while(!b.isCommandOrEnd()){var e=b.current;var d=b.getAsCurrentPoint();b.addMarker(d,e);c.addPoint(d.x,d.y);if(a!=null)a.lineTo(d.x,d.y)}}else if(b.command.toUpperCase()=="H"){while(!b.isCommandOrEnd()){var f=new svg.Point((b.isRelativeCommand()?b.current.x:0)+b.getScalar(),b.current.y);b.addMarker(f,b.current);b.current=f;c.addPoint(b.current.x,b.current.y);if(a!=null)a.lineTo(b.current.x,b.current.y)}}else if(b.command.toUpperCase()=="V"){while(!b.isCommandOrEnd()){var f=new svg.Point(b.current.x,(b.isRelativeCommand()?b.current.y:0)+b.getScalar());b.addMarker(f,b.current);b.current=f;c.addPoint(b.current.x,b.current.y);if(a!=null)a.lineTo(b.current.x,b.current.y)}}else if(b.command.toUpperCase()=="C"){while(!b.isCommandOrEnd()){var g=b.current;var h=b.getPoint();var i=b.getAsControlPoint();var j=b.getAsCurrentPoint();b.addMarker(j,i);c.addBezierCurve(g.x,g.y,h.x,h.y,i.x,i.y,j.x,j.y);if(a!=null)a.bezierCurveTo(h.x,h.y,i.x,i.y,j.x,j.y)}}else if(b.command.toUpperCase()=="S"){while(!b.isCommandOrEnd()){var g=b.current;var h=b.getReflectedControlPoint();var i=b.getAsControlPoint();var j=b.getAsCurrentPoint();b.addMarker(j,i);c.addBezierCurve(g.x,g.y,h.x,h.y,i.x,i.y,j.x,j.y);if(a!=null)a.bezierCurveTo(h.x,h.y,i.x,i.y,j.x,j.y)}}else if(b.command.toUpperCase()=="Q"){while(!b.isCommandOrEnd()){var g=b.current;var i=b.getAsControlPoint();var j=b.getAsCurrentPoint();b.addMarker(j,i);c.addQuadraticCurve(g.x,g.y,i.x,i.y,j.x,j.y);if(a!=null)a.quadraticCurveTo(i.x,i.y,j.x,j.y)}}else if(b.command.toUpperCase()=="T"){while(!b.isCommandOrEnd()){var g=b.current;var i=b.getReflectedControlPoint();b.control=i;var j=b.getAsCurrentPoint();b.addMarker(j,i);c.addQuadraticCurve(g.x,g.y,i.x,i.y,j.x,j.y);if(a!=null)a.quadraticCurveTo(i.x,i.y,j.x,j.y)}}else if(b.command.toUpperCase()=="A"){while(!b.isCommandOrEnd()){var g=b.current;var k=b.getScalar();var l=b.getScalar();var m=b.getScalar()*(Math.PI/180);var n=b.getScalar();var o=b.getScalar();var j=b.getAsCurrentPoint();var p=new svg.Point(Math.cos(m)*(g.x-j.x)/2+Math.sin(m)*(g.y-j.y)/2,-Math.sin(m)*(g.x-j.x)/2+Math.cos(m)*(g.y-j.y)/2);var q=Math.pow(p.x,2)/Math.pow(k,2)+Math.pow(p.y,2)/Math.pow(l,2);if(q>1){k*=Math.sqrt(q);l*=Math.sqrt(q)}var r=(n==o?-1:1)*Math.sqrt((Math.pow(k,2)*Math.pow(l,2)-Math.pow(k,2)*Math.pow(p.y,2)-Math.pow(l,2)*Math.pow(p.x,2))/(Math.pow(k,2)*Math.pow(p.y,2)+Math.pow(l,2)*Math.pow(p.x,2)));if(isNaN(r))r=0;var s=new svg.Point(r*k*p.y/l,r*-l*p.x/k);var t=new svg.Point((g.x+j.x)/2+Math.cos(m)*s.x-Math.sin(m)*s.y,(g.y+j.y)/2+Math.sin(m)*s.x+Math.cos(m)*s.y);var u=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))};var v=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(u(a)*u(b))};var w=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(v(a,b))};var x=w([1,0],[(p.x-s.x)/k,(p.y-s.y)/l]);var y=[(p.x-s.x)/k,(p.y-s.y)/l];var z=[(-p.x-s.x)/k,(-p.y-s.y)/l];var A=w(y,z);if(v(y,z)<=-1)A=Math.PI;if(v(y,z)>=1)A=0;if(o==0&&A>0)A=A-2*Math.PI;if(o==1&&A<0)A=A+2*Math.PI;var B=new svg.Point(t.x-k*Math.cos((x+A)/2),t.y-l*Math.sin((x+A)/2));b.addMarkerAngle(B,(x+A)/2+(o==0?1:-1)*Math.PI/2);b.addMarkerAngle(j,A+(o==0?1:-1)*Math.PI/2);c.addPoint(j.x,j.y);if(a!=null){var v=k>l?k:l;var C=k>l?1:k/l;var D=k>l?l/k:1;a.translate(t.x,t.y);a.rotate(m);a.scale(C,D);a.arc(0,0,v,x,x+A,1-o);a.scale(1/C,1/D);a.rotate(-m);a.translate(-t.x,-t.y)}}}else if(b.command.toUpperCase()=="Z"){if(a!=null)a.closePath()}}return c};this.getMarkers=function(){var a=this.PathParser.getMarkerPoints();var b=this.PathParser.getMarkerAngles();var c=[];for(var d=0;d<a.length;d++){c.push([a[d],b[d]])}return c}};svg.Element.path.prototype=new svg.Element.PathElementBase;svg.Element.pattern=function(a){this.base=svg.Element.ElementBase;this.base(a);this.createPattern=function(a,b){var c=new svg.Element.svg;c.attributes["viewBox"]=new svg.Property("viewBox",this.attribute("viewBox").value);c.attributes["x"]=new svg.Property("x",this.attribute("x").value);c.attributes["y"]=new svg.Property("y",this.attribute("y").value);c.attributes["width"]=new svg.Property("width",this.attribute("width").value);c.attributes["height"]=new svg.Property("height",this.attribute("height").value);c.children=this.children;var d=document.createElement("canvas");d.width=this.attribute("width").Length.toPixels();d.height=this.attribute("height").Length.toPixels();c.render(d.getContext("2d"));return a.createPattern(d,"repeat")}};svg.Element.pattern.prototype=new svg.Element.ElementBase;svg.Element.marker=function(a){this.base=svg.Element.ElementBase;this.base(a);this.baseRender=this.render;this.render=function(a,b,c){a.translate(b.x,b.y);if(this.attribute("orient").valueOrDefault("auto")=="auto")a.rotate(c);if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth")a.scale(a.lineWidth,a.lineWidth);a.save();var d=new svg.Element.svg;d.attributes["viewBox"]=new svg.Property("viewBox",this.attribute("viewBox").value);d.attributes["refX"]=new svg.Property("refX",this.attribute("refX").value);d.attributes["refY"]=new svg.Property("refY",this.attribute("refY").value);d.attributes["width"]=new svg.Property("width",this.attribute("markerWidth").value);d.attributes["height"]=new svg.Property("height",this.attribute("markerHeight").value);d.attributes["fill"]=new svg.Property("fill",this.attribute("fill").valueOrDefault("black"));d.attributes["stroke"]=new svg.Property("stroke",this.attribute("stroke").valueOrDefault("none"));d.children=this.children;d.render(a);a.restore();if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth")a.scale(1/a.lineWidth,1/a.lineWidth);if(this.attribute("orient").valueOrDefault("auto")=="auto")a.rotate(-c);a.translate(-b.x,-b.y)}};svg.Element.marker.prototype=new svg.Element.ElementBase;svg.Element.defs=function(a){this.base=svg.Element.ElementBase;this.base(a);this.render=function(a){}};svg.Element.defs.prototype=new svg.Element.ElementBase;svg.Element.GradientBase=function(a){this.base=svg.Element.ElementBase;this.base(a);this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox");this.stops=[];for(var b=0;b<this.children.length;b++){var c=this.children[b];this.stops.push(c)}this.getGradient=function(){};this.createGradient=function(a,b){var c=this.getGradient(a,b);for(var d=0;d<this.stops.length;d++){c.addColorStop(this.stops[d].offset,this.stops[d].color)}return c}};svg.Element.GradientBase.prototype=new svg.Element.ElementBase;svg.Element.linearGradient=function(a){this.base=svg.Element.GradientBase;this.base(a);this.getGradient=function(a,b){var c=b.getBoundingBox();var d=this.gradientUnits=="objectBoundingBox"?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").Length.toPixels("x");var e=this.gradientUnits=="objectBoundingBox"?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").Length.toPixels("y");var f=this.gradientUnits=="objectBoundingBox"?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").Length.toPixels("x");var g=this.gradientUnits=="objectBoundingBox"?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").Length.toPixels("y");return a.createLinearGradient(d,e,f,g)}};svg.Element.linearGradient.prototype=new svg.Element.GradientBase;svg.Element.radialGradient=function(a){this.base=svg.Element.GradientBase;this.base(a);this.getGradient=function(a,b){var c=b.getBoundingBox();var d=this.gradientUnits=="objectBoundingBox"?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").Length.toPixels("x");var e=this.gradientUnits=="objectBoundingBox"?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").Length.toPixels("y");var f=d;var g=e;if(this.attribute("fx").hasValue()){f=this.gradientUnits=="objectBoundingBox"?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").Length.toPixels("x")}if(this.attribute("fy").hasValue()){g=this.gradientUnits=="objectBoundingBox"?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").Length.toPixels("y")}var h=this.gradientUnits=="objectBoundingBox"?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").Length.toPixels();return a.createRadialGradient(f,g,0,d,e,h)}};svg.Element.radialGradient.prototype=new svg.Element.GradientBase;svg.Element.stop=function(a){this.base=svg.Element.ElementBase;this.base(a);this.offset=this.attribute("offset").numValue();var b=this.style("stop-color");if(this.style("stop-opacity").hasValue())b=b.Color.addOpacity(this.style("stop-opacity").value);this.color=b.value};svg.Element.stop.prototype=new svg.Element.ElementBase;svg.Element.AnimateBase=function(a){this.base=svg.Element.ElementBase;this.base(a);svg.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").Time.toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").Time.toMilliseconds();this.calcValue=function(){return""};this.update=function(a){if(this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"){this.duration=0}else{return false}}this.duration=this.duration+a;var b=false;if(this.begin<this.duration){var c=this.calcValue();var d=this.attribute("attributeType").value;var e=this.attribute("attributeName").value;if(this.parent!=null){if(d=="CSS"){this.parent.style(e,true).value=c}else{if(this.attribute("type").hasValue()){var f=this.attribute("type").value;this.parent.attribute(e,true).value=f+"("+c+")"}else{this.parent.attribute(e,true).value=c}}b=true}}return b};this.progress=function(){return(this.duration-this.begin)/(this.maxDuration-this.begin)}};svg.Element.AnimateBase.prototype=new svg.Element.ElementBase;svg.Element.animate=function(a){this.base=svg.Element.AnimateBase;this.base(a);this.calcValue=function(){var a=this.attribute("from").numValue();var b=this.attribute("to").numValue();return a+(b-a)*this.progress()}};svg.Element.animate.prototype=new svg.Element.AnimateBase;svg.Element.animateColor=function(a){this.base=svg.Element.AnimateBase;this.base(a);this.calcValue=function(){var a=new RGBColor(this.attribute("from").value);var b=new RGBColor(this.attribute("to").value);if(a.ok&&b.ok){var c=a.r+(b.r-a.r)*this.progress();var d=a.g+(b.g-a.g)*this.progress();var e=a.b+(b.b-a.b)*this.progress();return"rgb("+parseInt(c,10)+","+parseInt(d,10)+","+parseInt(e,10)+")"}return this.attribute("from").value}};svg.Element.animateColor.prototype=new svg.Element.AnimateBase;svg.Element.animateTransform=function(a){
this.base=svg.Element.animate;this.base(a)};svg.Element.animateTransform.prototype=new svg.Element.animate;svg.Element.text=function(a){this.base=svg.Element.RenderedElementBase;this.base(a);if(a!=null){this.children=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c.nodeType==1){this.addChild(c,true)}else if(c.nodeType==3){this.addChild(new svg.Element.tspan(c),false)}}}this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);if(this.attribute("text-anchor").hasValue()){var b=this.attribute("text-anchor").value;a.textAlign=b=="middle"?"center":b}if(this.attribute("alignment-baseline").hasValue())a.textBaseline=this.attribute("alignment-baseline").value};this.renderChildren=function(a){var b=this.attribute("x").Length.toPixels("x");var c=this.attribute("y").Length.toPixels("y");for(var d=0;d<this.children.length;d++){this.children[d].x=b;this.children[d].y=c;this.children[d].render(a);b+=this.children[d].measureText(a)}}};svg.Element.text.prototype=new svg.Element.RenderedElementBase;svg.Element.TextElementBase=function(a){this.base=svg.Element.RenderedElementBase;this.base(a);this.renderChildren=function(a){a.fillText(svg.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureText=function(a){return a.measureText(svg.compressSpaces(this.getText())).width}};svg.Element.TextElementBase.prototype=new svg.Element.RenderedElementBase;svg.Element.tspan=function(a){this.base=svg.Element.TextElementBase;this.base(a);this.text=a.nodeType==3?a.nodeValue:a.childNodes[0].nodeValue;this.getText=function(){return this.text}};svg.Element.tspan.prototype=new svg.Element.TextElementBase;svg.Element.tref=function(a){this.base=svg.Element.TextElementBase;this.base(a);this.getText=function(){var a=this.attribute("xlink:href").Definition.getDefinition();if(a!=null)return a.children[0].getText()}};svg.Element.tref.prototype=new svg.Element.TextElementBase;svg.Element.g=function(a){this.base=svg.Element.RenderedElementBase;this.base(a)};svg.Element.g.prototype=new svg.Element.RenderedElementBase;svg.Element.symbol=function(a){this.base=svg.Element.RenderedElementBase;this.base(a)};svg.Element.symbol.prototype=new svg.Element.RenderedElementBase;svg.Element.a=function(a){this.base=svg.Element.RenderedElementBase;this.base(a)};svg.Element.a.prototype=new svg.Element.RenderedElementBase;svg.Element.style=function(a){this.base=svg.Element.ElementBase;this.base(a);var b=a.childNodes[0].nodeValue;b=b.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(\/\/.*)/gm,"");b=svg.compressSpaces(b);var c=b.split("}");for(var d=0;d<c.length;d++){if(svg.trim(c[d])!=""){var e=c[d].split("{");var f=e[0].split(",");var g=e[1].split(";");for(var h=0;h<f.length;h++){var i=svg.trim(f[h]);if(i!=""){var j={};for(var k=0;k<g.length;k++){var l=g[k].split(":");var m=l[0];var n=l[1];if(m!=null&&n!=null){j[svg.trim(l[0])]=new svg.Property(svg.trim(l[0]),svg.trim(l[1]))}}svg.Styles[i]=j}}}}};svg.Element.style.prototype=new svg.Element.ElementBase;svg.Element.use=function(a){this.base=svg.Element.RenderedElementBase;this.base(a);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);if(this.attribute("x").hasValue())a.translate(this.attribute("x").Length.toPixels("x"),0);if(this.attribute("y").hasValue())a.translate(0,this.attribute("y").Length.toPixels("y"))};this.renderChildren=function(a){var b=this.attribute("xlink:href").Definition.getDefinition();if(b!=null)b.render(a)}};svg.Element.use.prototype=new svg.Element.RenderedElementBase;svg.Element.clipPath=function(a){this.base=svg.Element.ElementBase;this.base(a);this.apply=function(a){for(var b=0;b<this.children.length;b++){if(this.children[b].path){this.children[b].path(a);a.clip()}}}};svg.Element.clipPath.prototype=new svg.Element.ElementBase;svg.Element.title=function(a){};svg.Element.title.prototype=new svg.Element.ElementBase;svg.Element.desc=function(a){};svg.Element.desc.prototype=new svg.Element.ElementBase;svg.Element.MISSING=function(a){console.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")};svg.Element.MISSING.prototype=new svg.Element.ElementBase;svg.CreateElement=function(node){var className="svg.Element."+node.nodeName.replace(/^[^:]+:/,"");if(!eval(className))className="svg.Element.MISSING";var e=eval("new "+className+"(node)");e.type=node.nodeName;return e};svg.load=function(a,b){svg.loadXml(a,svg.ajax(b))};svg.loadXml=function(a,b){svg.init(a);var c=svg.parseXml(b);var d=svg.CreateElement(c.documentElement);if(d.attribute("width").hasValue()){a.canvas.width=d.attribute("width").Length.toPixels(a.canvas.parentNode.clientWidth)}if(d.attribute("height").hasValue()){a.canvas.height=d.attribute("height").Length.toPixels(a.canvas.parentNode.clientHeight)}svg.ViewPort.SetCurrent(a.canvas.clientWidth,a.canvas.clientHeight);a.clearRect(0,0,a.canvas.clientWidth,a.canvas.clientHeight);d.render(a);svg.intervalID=setInterval(function(){var b=false;for(var c=0;c<svg.Animations.length;c++){b=b|svg.Animations[c].update(1e3/svg.FRAMERATE)}if(b){a.clearRect(0,0,a.canvas.clientWidth,a.canvas.clientHeight);d.render(a)}},1e3/svg.FRAMERATE)};svg.stop=function(){if(svg.intervalID){clearInterval(svg.intervalID)}};return svg}})();